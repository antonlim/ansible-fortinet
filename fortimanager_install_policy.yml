- hosts: DC-MGT-Forti-CNI-FMG-21
  connection: httpapi
  collections: 
    - fortinet.fortimanager
  vars:
    ansible_httpapi_use_ssl: True
    ansible_httpapi_validate_certs: False
    ansible_httpapi_port: 443
    adom: "root"
    pkg: "DC-FW-Forti-CNI-FG-08-16_FGT-EW"
    device: "DC-FW-Forti-CNI-FG-08-16"
    vdom: "FGT-EW"
  tasks:
    - name: Install for policy package
      fmgr_securityconsole_install_package:
        bypass_validation: False
        workspace_locking_adom: "{{ adom }}"
        workspace_locking_timeout: 300
        rc_succeeded: [0, -2, -3, ...]
        rc_failed: [-2, -3, ...]
        securityconsole_install_package:
          adom: "{{ adom }}"
          adom_rev_comments: "ansible"
          adom_rev_name: "ansible"
          dev_rev_comments: "ansible"
          flags:
            - none
            - cp_all_objs
            - preview
            - generate_rev
            - copy_assigned_pkg
            - unassign
            - ifpolicy_only
            - no_ifpolicy
            - objs_only
            - auto_lock_ws
            - check_pkg_st
            - copy_only
          pkg: "{{ pkg }}"
          scope:
            - name: "{{ device }}"
            - vdom: "{{ vdom }}"
      register: r